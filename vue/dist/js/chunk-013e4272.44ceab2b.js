(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-013e4272"],{"541c":function(e,r,l){"use strict";l("7f50")},"771a":function(e,r,l){"use strict";l.r(r);var o=function(){var e=this,r=e.$createElement,l=e._self._c||r;return l("div",{attrs:{id:"main"}},[l("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"密码",prop:"password"}},[l("el-input",{attrs:{placeholder:"请先输入账户密码",type:"password","show-password":""},model:{value:e.ruleForm.password,callback:function(r){e.$set(e.ruleForm,"password",r)},expression:"ruleForm.password"}})],1),l("el-form-item",{attrs:{label:"原邮箱",prop:"old_email"}},[l("el-input",{attrs:{placeholder:"请先输入原邮箱"},model:{value:e.ruleForm.old_email,callback:function(r){e.$set(e.ruleForm,"old_email",r)},expression:"ruleForm.old_email"}})],1),l("el-form-item",{attrs:{label:"新邮箱",prop:"new_email"}},[l("el-input",{attrs:{placeholder:"请输入新邮箱"},model:{value:e.ruleForm.new_email,callback:function(r){e.$set(e.ruleForm,"new_email",r)},expression:"ruleForm.new_email"}})],1)],1),l("el-button",{staticClass:"editButton",attrs:{type:"primary"},on:{click:function(r){return e.submitForm_email("ruleForm")}}},[e._v("修改")])],1)},s=[],a={name:"ModifyEmail",beforeMount:function(){var e=this;this.selfLog(this.user_profile),null===this.user_profile&&this.$axios.user_profile().then((function(r){e.user_profile=r["data"],e.selfLog(e.user_profile)}))},data:function(){var e=this,r=function(e,r,l){""===r&&l(new Error("请输入密码")),(r.length<6||r.length>20)&&l(new Error("长度应在 6 到 20 个字符"))},l=function(e){return/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((.[a-zA-Z0-9_-]{2,3}){1,2})$/.test(e)},o=function(e,r,o){""===r&&o(new Error("邮箱不能为空")),l(r)||o(new Error("邮箱格式错误"))},s=function(r,o,s){""===o&&s(new Error("邮箱不能为空")),l(o)||s(new Error("邮箱格式错误")),o===e.ruleForm.old_email&&s(new Error("新邮箱不能与旧邮箱一样"))};return{user_profile:this.$root.user_profile,enable:!0,ruleForm:{password:"",old_email:"",new_email:""},rules:{password:[{validator:r,trigger:"blur"}],old_email:[{validator:o,trigger:"blur"}],new_email:[{validator:s,trigger:"blur"}]}}},methods:{submitForm_email:function(e){var r=this;this.ruleForm.old_email=this.user_profile.user.email,this.$refs[e].validate((function(e){if(e){var l={new_email:r.ruleForm.new_email,old_email:r.ruleForm.old_email,password:r.ruleForm.old_password};r.selfLog(l),r.$axios.change_email(l).then((function(e){if(r.selfLog(e),"Wrong password"===e["data"])r.$message.error("原密码错误");else if("The email is owned by other account"===e["data"])r.$message({message:"该邮件地址已被注册",type:"warning"});else if(null===e["error"]){r.$message({message:"邮件修改成功",type:"success"});var l=new Date,o={userId:r.user_profile.id,msg:l.toLocaleString()+":修改绑定邮箱地址",type:1};r.$axios.send_sys_info(o)}else"permission-denied"===e["error"]&&(r.$message({message:"修改邮件需要登录",type:"warning"}),r.$router.push("/login"))}))}}))}}},t=a,i=(l("541c"),l("2877")),n=Object(i["a"])(t,o,s,!1,null,"3050f6e3",null);r["default"]=n.exports},"7f50":function(e,r,l){}}]);
//# sourceMappingURL=chunk-013e4272.44ceab2b.js.map